<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Panel - Andrés Raíz</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="panel">
    <img src="assets/logo.png" class="logo" alt="Logo"/>
    <h2>Bienvenido, <span id="nombre"></span></h2>

    <div class="info-box">
      <p><strong>Cédula:</strong> <span id="cedula"></span></p>
      <p><strong>Cargo:</strong> <span id="cargo"></span></p>
      <p><strong>Fecha de ingreso:</strong> <span id="ingreso"></span></p>
      <p><strong>Vacaciones acumuladas:</strong> <span id="vacaciones"></span> días</p>
    </div>

    <div class="btn-group">
      <button onclick="descargarColilla()">Ver colilla de este mes</button>
      <button onclick="generarCertificado()">Generar certificado laboral</button>
      <button onclick="cerrarSesion()">Cerrar sesión</button>
    </div>

    <iframe id="visor" style="display:none;" width="100%" height="500px"></iframe>
  </div>

  <script>
    const empleado = JSON.parse(localStorage.getItem('empleado'));
    if (!empleado) {
      window.location.href = "index.html";
    } else {
      document.getElementById('nombre').innerText = empleado.nombre;
      document.getElementById('cedula').innerText = empleado.cedula;
      document.getElementById('cargo').innerText = empleado.cargo;
      document.getElementById('ingreso').innerText = empleado.ingreso;

      // Cálculo de vacaciones automáticas
      const fechaIngreso = new Date(empleado.ingreso);
      const hoy = new Date();
      const años = hoy.getFullYear() - fechaIngreso.getFullYear();
      const meses = hoy.getMonth() - fechaIngreso.getMonth();
      const totalMeses = (años * 12) + meses;
      const diasVacaciones = Math.floor((15 / 12) * totalMeses) - (empleado.vacaciones || 0);
      document.getElementById('vacaciones').innerText = diasVacaciones;
    }

    function descargarColilla() {
      const mes = new Date().toISOString().slice(0, 7);
      const path = `colillas/${empleado.cedula}/${mes}.pdf`;
      document.getElementById("visor").src = path;
      document.getElementById("visor").style.display = "block";
    }

function numeroALetras(valor) {
  // Conversión básica para los valores que usas
  if (valor === 1423500) return "UN MILLÓN CUATROCIENTOS VEINTITRÉS MIL QUINIENTOS PESOS COLOMBIANOS";
  if (valor === 200000) return "DOSCIENTOS MIL PESOS COLOMBIANOS";
  if (valor === 350000) return "TRESCIENTOS CINCUENTA MIL PESOS COLOMBIANOS";
  if (valor === 2400000) return "DOS MILLONES CUATROCIENTOS MIL PESOS COLOMBIANOS";
  return valor + " PESOS";
}

function generarCertificado() {
  <script>
function numeroALetras(valor) {
  if (valor === 1423500) return "UN MILLÓN CUATROCIENTOS VEINTITRÉS MIL QUINIENTOS PESOS COLOMBIANOS";
  if (valor === 200000) return "DOSCIENTOS MIL PESOS COLOMBIANOS";
  if (valor === 350000) return "TRESCIENTOS CINCUENTA MIL PESOS COLOMBIANOS";
  if (valor === 2400000) return "DOS MILLONES CUATROCIENTOS MIL PESOS COLOMBIANOS";
  return valor + " PESOS";
}

function generarCertificado() {
  const fechaHoy = new Date().toLocaleDateString('es-CO', {
    day: 'numeric', month: 'long', year: 'numeric'
  });

  const html = `
  <div style="width: 750px; margin: 0 auto; font-family: 'Segoe UI', sans-serif; font-size: 15px; color: #000;">
    <div style="text-align: center; margin-bottom: 20px;">
      <img src="assets/logo.png" alt="Logo" style="height: 80px; margin-bottom: 10px;">
      <h2 style="margin: 0;">ANDRÉS RAÍZ INMOBILIARIA S.A.S</h2>
      <p style="margin: 0;">NIT: 901.524.934-1</p>
    </div>

    <p style="text-align: right;">Sabaneta, ${fechaHoy}</p>

    <h2 style="text-align: center; margin: 30px 0;">A QUIEN PUEDA INTERESAR</h2>

    <p style="text-align: justify;">
      ANDRÉS RAÍZ INMOBILIARIA S.A.S certifica que el señor <strong>${empleado.nombre}</strong>, identificado con cédula de ciudadanía No. <strong>${empleado.cedula}</strong>,
      labora en nuestra compañía desde el <strong>${empleado.ingreso}</strong> hasta la fecha bajo el cargo de <strong>${empleado.cargo}</strong>,
      mediante contrato a término indefinido con un salario básico mensual de 
      ${numeroALetras(empleado.salario)} ($${empleado.salario.toLocaleString("es-CO")}), más auxilio de transporte 
      ${numeroALetras(empleado.transporte)} ($${empleado.transporte.toLocaleString("es-CO")}),
      auxilio de rodamiento ${numeroALetras(empleado.rodamiento)} ($${empleado.rodamiento.toLocaleString("es-CO")}), 
      y comisiones no constitutivas de salario en promedio de 
      ${numeroALetras(empleado.comisiones)} ($${empleado.comisiones.toLocaleString("es-CO")}).
    </p>

    <p style="text-align: justify;">
      Este certificado se expide a solicitud del interesado para los fines que estime convenientes.
      Para más información puede comunicarse al correo <strong>servicio@andresraiz.com</strong> o a los teléfonos 3588564 y 3245366761.
    </p>

    <br><br><br>
    <p style="text-align: center;">______________________________</p>
    <p style="text-align: center;"><strong>JADISON ARLEY MENDOZA TABARES</strong><br>Representante Legal Suplente</p>
  </div>
  `;

  const win = window.open('', '_blank');
  win.document.write(`<html><head><title>Certificado</title></head><body>${html}</body></html>`);
  win.document.close();
  win.print();
}
</script>



    function cerrarSesion() {
      localStorage.removeItem('empleado');
      window.location.href = "index.html";
    }
  </script>
</body>
</html>
